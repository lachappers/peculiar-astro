---
import { Image } from "astro:assets";
import { Icon } from "astro-icon/components";
import { getCollection } from "astro:content";

import BlogCard from "@components/common/BlogCard.astro";
import SectionHeading from "@components/shared/SectionHeading.astro";
import Button from "@components/Button.astro";

const { subtitle, title, id } = Astro.props;

const recentBlogPosts = (
  await getCollection("blog", ({ data }) => {
    // return data.draft !== true;
    return import.meta.env.PROD ? data.draft !== true : true;
  })
)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, 3);
---

<div
  class="container my-4 flex w-full max-w-screen-xl flex-col items-center justify-center gap-4 py-16 sm:p-8"
>
  <SectionHeading subtitle={subtitle} title={title} id={id}>
    <slot />
  </SectionHeading>

  {
    recentBlogPosts.length === 0 ? (
      <h2>No Recent Posts - Yet!</h2>
    ) : (
      //   <ul class="grid max-w-xs grid-cols-1 place-items-center gap-6 sm:max-w-lg md:max-w-4xl lg:grid-cols-3">
      <ul class="flex w-full flex-col items-center justify-center gap-4 lg:flex-row">
        {recentBlogPosts.map((blog) => (
          <BlogCard data={blog} />
        ))}
      </ul>
    )
  }
  <div class="mt-4 flex w-full justify-center gap-4">
    <Button
      href="/blog"
      icon="mdi:arrow-right"
      text="Read More Posts"
      buttonColor="color-secondary"
    />
  </div>
</div>
